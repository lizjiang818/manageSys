# 组织架构Excel文件说明

## 文件位置

生成的Excel文件位于：`backend/organization_structure.xlsx`

## 文件内容

Excel文件包含完整的灵隐寺组织架构数据，共 **41条记录**，包括：

### 顶层（层级0）
- 寺管会
- 监管会
- 住持

### 第一层（层级1）- 住持直接管理
- 维那
- 监院一
- 监院二
- 监院三
- 监院四
- 监院五
- 方丈办

### 第二层（层级2）- 各部门
- **维那下**：禅堂、念佛堂、法堂
- **监院一下**：寮元、监修、司库、十方苑、典座、财务
- **监院二下**：基金会、编辑部、禅茶中心、围棋中心、云林书院、文宣部、培训中心、图书馆、造像艺术中心、非物质文化中心、数字佛典中心
- **监院三下**：殿堂案、客堂
- **监院四下**：安保部、流通处、僧值
- **方丈办下**：档案、医务室

### 第三层（层级3）- 客堂子部门
- 人事培训
- 法务
- 行政
- 接待

## Excel文件格式

| 列名 | 说明 | 示例 |
|------|------|------|
| 层级 | 数字，0为顶层 | 0, 1, 2, 3 |
| 名称 | 节点名称 | 住持、维那、禅堂 |
| 类型 | 委员会/职位/部门/子部门 | 职位、部门 |
| 负责人 | 负责人姓名（可选） | 释xxx、释xx法师 |
| 父节点 | 父节点名称（根节点为空） | 住持、维那 |
| 排序 | 同级排序序号 | 1, 2, 3 |
| 人员 | 部门人员信息（可选） | 张三、张三,李四、张三:组长,李四:法务 |

## 重新生成Excel文件

如果需要重新生成Excel文件，可以运行：

```bash
cd backend
npm run generate-excel
```

或者直接使用tsx：

```bash
cd backend
npx tsx src/scripts/generateExcel.ts
```

## 使用Excel文件

1. **上传到系统**：
   - 启动后端服务器：`npm run dev`
   - 使用API上传：`POST /api/organization/upload`
   - 或者通过前端界面上传

2. **修改数据**：
   - 可以直接在Excel中编辑数据
   - 修改后重新上传即可更新数据库

3. **数据验证**：
   - 确保层级连续（不能跳过层级）
   - 父节点必须存在
   - 名称不能为空
   - 类型必须是：委员会、职位、部门、子部门

## 注意事项

- Excel文件使用UTF-8编码，支持中文
- 第一行为表头，数据从第二行开始
- 父节点为空时填写 "-" 或不填
- 负责人为空时填写 "-" 或不填
- 人员为空时填写 "-" 或不填
- 人员格式支持：
  - 简单格式：`张三,李四,王五` - 多个人员用逗号分隔（支持中文逗号"，"和英文逗号","），职位为空
  - 带职位格式：`张三:组长,李四:法务,王五:法务` - 使用冒号分隔姓名和职位
  - 混合格式：`张三:组长,李四,王五` - 可以混合使用（有冒号的带职位，没有冒号的职位为空）
  - **注意**：如果Excel中没有写职位（没有冒号），则职位字段为空，前端只显示姓名

